<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Compute</title>
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1"> -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="Overview1_stylesheet.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- Bootstrap CSS
		============================================ -->
    <!-- <link rel="stylesheet" href="css/font-awesome.min.css"> -->
	  <!-- nalika Icon CSS
		============================================ -->
    <link rel="stylesheet" href="css/nalika-icon.css">
    <!-- owl.carousel CSS
		============================================ -->
    <link rel="stylesheet" href="css/owl.carousel.css">
    <link rel="stylesheet" href="css/owl.theme.css">
    <link rel="stylesheet" href="css/owl.transitions.css">
    <!-- animate CSS
		============================================ -->
    <link rel="stylesheet" href="css/animate.css">
    <!-- normalize CSS
		============================================ -->
    <link rel="stylesheet" href="css/normalize.css">
    <!-- meanmenu icon CSS
		============================================ -->
    <link rel="stylesheet" href="css/meanmenu.min.css">
    <!-- main CSS
		============================================ -->
    <link rel="stylesheet" href="css/main.css">
    <!-- morrisjs CSS
		============================================ -->
    <link rel="stylesheet" href="css/morrisjs/morris.css">
    <!-- mCustomScrollbar CSS
		============================================ -->
    <link rel="stylesheet" href="css/scrollbar/jquery.mCustomScrollbar.min.css">
    <!-- metisMenu CSS
		============================================ -->
    <link rel="stylesheet" href="css/metisMenu/metisMenu.min.css">
    <link rel="stylesheet" href="css/metisMenu/metisMenu-vertical.css">
    <!-- calendar CSS
		============================================ -->
    <link rel="stylesheet" href="css/calendar/fullcalendar.min.css">
    <link rel="stylesheet" href="css/calendar/fullcalendar.print.min.css">
    <!-- style CSS
		============================================ -->
    <link rel="stylesheet" href="style.css">
    <!-- responsive CSS
		============================================ -->
    <link rel="stylesheet" href="css/responsive.css">
    <!-- modernizr JS
		============================================ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.8.2/css/bulma.min.css">
    <script defer src="https://use.fontawesome.com/releases/v5.13.0/js/all.js"></script>
    <!-- <link rel="stylesheet" href="debug.css"> -->
</head>


<body>
  <section class="hero" style="background-color: #152036;">

    <!--Navigation pills-->
    <div class="hero-head d-flex justify-content-center" style="padding-top: 55px">
      <div class="btn-group">
        <a href="Cluster.html" class="btn">Cluster</a>               <!--Insert link of the other page-->
        <a href="Compute.html" class="btn text-dark">Compute</a>
        <!-- <a href="Details1.html" class="btn btn-success">Details</a> -->
      </div>
    </div>

    <!-- content -->
    <div class="hero-body">
      <div class="container">
        <div class="columns">


          <div id="whole_cluster" class="column is-two-fifths">
             <!-- Pi Controller -->

          </div>


          <!-- System Monitor -->
          <div class="column">

            <div class="admin-content analysis-progrebar-ctn res-mg-t-15">
              <div class="tile is-ancestor justify-content-center">
                <p id="big-header" class="title is-size-2" style="color: antiquewhite;"></p>
              </div>
              <h4 class="text-uppercase"><b>CPU</b></h4>
              <div class="row vertical-center-box vertical-center-box-tablet">
                <div class="col-xs-3 mar-bot-15 text-left">
                  <label id="cpu-percentage" class="label bg-green">0%</label>
                </div>
                <div class="col-xs-9 cus-gh-hd-pro">
                  <h2 id="cpu-usage" class="text-right no-margin"></h2>
                </div>
              </div>
              <progress id="cpu-progress-bar" class="progress is-primary" value="0" max="100"></progress>
            </div>

            <div class="admin-content analysis-progrebar-ctn res-mg-t-15">
              <h4 class="text-uppercase"><b>RAM</b></h4>
              <div class="row vertical-center-box vertical-center-box-tablet">
                <div class="col-xs-3 mar-bot-15 text-left">
                  <label class="label bg-green">46%</label>
                </div>
                <div class="col-xs-9 cus-gh-hd-pro">
                  <h2 class="text-right no-margin">3.3/7.2 GB</h2>
                </div>
              </div>
              <progress class="progress is-primary" value="46" max="100">46%</progress>
            </div>

            <div class="admin-content analysis-progrebar-ctn res-mg-t-15">
              <h4 class="text-uppercase"><b>DISK</b></h4>
              <div class="row vertical-center-box vertical-center-box-tablet">
                <div class="col-xs-3 mar-bot-15 text-left">
                  <label class="label bg-green">23%</label>
                </div>
                <div class="col-xs-9 cus-gh-hd-pro">
                  <h2 class="text-right no-margin">1.5/6.5 GB</h2>
                </div>
              </div>
              <progress class="progress is-primary" value="23" max="100">23%</progress>
            </div>

            <div class="admin-content analysis-progrebar-ctn res-mg-t-15">
              <h4 class="text-uppercase"><b>Power</b></h4>
              <div class="row vertical-center-box vertical-center-box-tablet">
                <div class="col-xs-3 mar-bot-15 text-left">
                  <label class="label bg-green">66%</label>
                </div>
                <div class="col-xs-9 cus-gh-hd-pro">
                  <h2 class="text-right no-margin">50 W</h2>
                </div>
              </div>
              <progress class="progress is-primary" value="66" max="100">66%</progress>
            </div>

            <!-- Information Pane -->
            <div class="tile is-child" style="padding-top: 20px;">
              <article class="tile is-child notification" style="color: black; background-color:rgb(5, 200, 159);"> 
                <div class="content">
                  <p class="title is-size-4" style="padding-bottom: 9px;">Information</p>
                  <p id="pi-model" class="subtitle is-size-6">Model:</p>
                  <p id="firm-ver" class="subtitle is-size-6">Firmware version:</p>
                  <p id="temp" class="subtitle is-size-6">Temperature:    CPU: 75 Celcius    Hat: 50 Celcius</p>
                  <p id="cpu-model" class="subtitle is-size-6"></p>
                  <p id="ram-usage" class="subtitle is-size-6">RAM:</p>
                  <p id="motherboard" class="subtitle is-size-6">Motherboard:</p>
                  <p id="os" class="subtitle is-size-6">OS:</p>
                  <p id="kernel" class="subtitle is-size-6">Kernel:</p>
                  <div class="level-left">
                    <p class="subtitle is-size-6 level-item">Power On/Off:</p>
                    <label class="switch">
                      <input id="on-off-button" type="checkbox">
                      <span class="slider round"></span>
                    </label>
                  </div>
                </div>
              </article>
            </div>
          </div>

        </div>
      </div>
    </div>

  </section>

<script>
  $(document).ready(function(){
    $('#btnPopover').popover();
});
</script>

<script>

  var cluster = {                                      //example array
      name: "Cluster 1",
      racks: [
          {
              name: "Rack 1",
              firmwareVersion: 1.0,
              servers: [
                  {
                      name: "Pi 1",
                      cpuModel: "BCM2711",
                      cpuUsage: 2,
                      poweredOn: true
                  },
                  {
                      name: "Pi 2",
                      cpuModel: "BCM2712",
                      cpuUsage: 2.5,
                      poweredOn: false
                  },
                  {
                      name: "Pi 3",
                      cpuModel: "BCM2710",
                      cpuUsage: 2.4,
                      poweredOn: true
                  },
                  {
                      name: "Pi 4",
                      cpuModel: "BCM2713",
                      cpuUsage: 1.7,
                      poweredOn: false
                  }
              ]
          },
          {
              name: "Rack 2",
              firmwareVersion: 2.0,
              servers: [
                  {
                      name: "Pi 1",
                      cpuModel: "BCM2714",
                      cpuUsage: 0.5,
                      poweredOn: true
                  },
                  {
                      name: "Pi 2",
                      cpuModel: "BCM2711",
                      cpuUsage: 0.8,
                      poweredOn: true
                  },
                  {
                      name: "Pi 3",
                      cpuModel: "BCM2713",
                      cpuUsage: 2.5,
                      poweredOn: false
                  },
                  {
                      name: "Pi 4",
                      cpuModel: "BCM2712",
                      cpuUsage: 2.9,
                      poweredOn: false
                  }
  
              ]
          }
      ]
  }
  
  var sl = 1;  
  var currentlySelectedServer = [cluster.racks[0].servers[0], 0, 0]

  function on_pi_click(e)
  {
    var rackIndex = parseInt(e.target.getAttribute("data-rack-index"))
    var serverIndex = parseInt(e.target.getAttribute("data-server-index"))
    currentlySelectedServer = [cluster.racks[rackIndex].servers[serverIndex], serverIndex, rackIndex]
    refreshDashboard()
  }

  function refreshDashboard() {
      var server = currentlySelectedServer[0]
      var serverIndex = currentlySelectedServer[1]
      var rackIndex = currentlySelectedServer[2]
      
      var cpuUsage = server.cpuUsage
      var cpuPercentage = Math.round(100*cpuUsage/3)
      var cpuModel = server.cpuModel
      document.querySelector("#big-header").innerText = "Pi ".concat(serverIndex+1, " - Rack ", rackIndex+1);
      document.querySelector("#cpu-percentage").innerText = "".concat(cpuPercentage, "%")
      document.querySelector("#cpu-usage").innerText = "".concat(cpuUsage, "/3GHz")
      document.querySelector("#cpu-progress-bar").innerHTML = toString(100*cpuUsage/3).concat("%")
      document.querySelector("#cpu-progress-bar").setAttribute("value", 100*cpuUsage/3)
      document.querySelector("#cpu-model").innerText = "CPU: ".concat(cpuModel)
      document.querySelector("#on-off-button").checked = server.poweredOn
      var nameElement = document.querySelectorAll('[data-server-index="' + serverIndex + '"][data-rack-index="'+ rackIndex + '"]')[0]
      nameElement.innerHTML = server.name + " (" + (server.poweredOn ? "on" : "off") + ")"
    }
  
  function on_rack_click(e){
  
  }
  
  function on_off_click(e)
  {
    currentlySelectedServer[0].poweredOn = !currentlySelectedServer[0].poweredOn
    refreshDashboard()
  }
  /* <div id="whole_cluster" class="column is-two-fifths">
               <!-- Pi Controller --></div> */
  
      // <div class="racks buttons btn-group-vertical btn-group-lg" style="width: 300px">
      // <button class="container btn disabled">
      //     <p>Rack 1</p>
      // </button>
      // <button class="container btn" onclick="click_a_pi(pi1, 1, 1)">
      //     <p>Raspberry Pi 1</p>
      // </button>
      // <button class="container btn" onclick="click_a_pi(pi2, 2, 1)">
      //     <p>Raspberry Pi 2</p>
      // </button>
      // <button class="container btn" onclick="click_a_pi(pi3, 3, 1)">
      //     <p>Raspberry Pi 3</p>
      // </button>
      // <button class="container btn" onclick="click_a_pi(pi4, 4, 1)">
      //     <p>Raspberry Pi 4</p>
      // </button>
      // </div>
  
  
  // </div>
  
  cluster.racks.forEach((rack, racki) => {
      var one_rack = document.createElement("div")
      one_rack.className = "racks buttons btn-group-vertical btn-group-lg"
      one_rack.style.width = "300px"
  
      var rack_button = document.createElement("button")
      rack_button.className="container btn disabled"
      rack_button.setAttribute("data-rack-index", racki)
      var rack_name = "Rack ".concat(racki+1)
      rack_button.textContent = rack_name
      //rack_button.addEventListener("click", on_rack_click)
  
      one_rack.appendChild(rack_button)
  
      rack.servers.forEach((server, serveri) => {
          var server_button = document.createElement("button")
          server_button.className = "container btn"
          server_button.textContent = server.name + " (" + (server.poweredOn ? "on" : "off") + ")"
          server_button.setAttribute("data-rack-index", racki)
          server_button.setAttribute("data-server-index", serveri)
          server_button.setAttribute("Ser-No", sl)
          server_button.addEventListener("click", on_pi_click)
          sl++
          one_rack.appendChild(server_button)
      })
      document.querySelector("#whole_cluster").appendChild(one_rack)
  })
  document.getElementById("on-off-button").addEventListener("click", on_off_click)
  </script>


</body>
</html>
